@model WebOS.Models.ApplicationUser
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    ApplicationUser currentUser = null;
    if (SignInManager.IsSignedIn(User))
    {
        currentUser = await UserManager.GetUserAsync(User);
    }
}

@{
    ViewData["Title"] = "التعديل على المستخدم";
}

<h5 class="text-center">التعديل على المستخدم</h5>
<partial name="_ViewHeader" />
<div class="px-5">


<div class="row">
    <div class="col-lg-12 bg-white p-2">
        <form asp-action="Edit" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="Id" />
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="RegistrationDate" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="RegistrationDate" class="form-control" disabled />
                    <span asp-validation-for="RegistrationDate" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1 col-lg-12 mt-1">
                <label asp-for="ReferredById" class="control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="ReferredById" class="form-control" disabled />
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="Status" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <select asp-for="Status" class="form-control"
                            asp-items="Html.GetEnumSelectList<StatusType>()">
                        <option disabled selected value="">Select a Status</option>
                    </select>
                    <span asp-validation-for="Status" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="UserName" class="col-md-2 control-label">إسم المستخدم</label>
                <div class="col-md-10">
                    <input asp-for="UserName" class="form-control" />
                    <span asp-validation-for="UserName" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label  class="col-md-2 control-label">البريد الالكتروني</label>
                <div class="col-md-10">
                    <input asp-for="Email" class="form-control" />
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="SecondEmail" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="SecondEmail" class="form-control" />
                    <span asp-validation-for="SecondEmail" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label class="col-md-2 control-label">رقم الهاتف</label>
                <div class="col-md-10">
                    <input asp-for="PhoneNumber" class="form-control" />
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="ArName" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="ArName" class="form-control" />
                    <span asp-validation-for="ArName" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="EnName" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="EnName" class="form-control" />
                    <span asp-validation-for="EnName" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="DateofBirth" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="DateofBirth" class="form-control" />
                    <span asp-validation-for="DateofBirth" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="Gender" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <select asp-for="Gender" class="form-control"
                            asp-items="Html.GetEnumSelectList<GenderType>()">
                        <option disabled selected value="">Select a Gender</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="UILanguage" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <select asp-for="UILanguage" class="form-control"
                            asp-items="Html.GetEnumSelectList<Language>()">
                        <option disabled selected value="">إختر لغة</option>
                    </select>
                    <span asp-validation-for="UILanguage" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="CountryId" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <select id="cntid" asp-for="CountryId" class="form-control" asp-items="@(ViewBag.CountryId)">
                        <option>Select Country</option>
                    </select>
                    <span asp-validation-for="CountryId" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="CityId" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <select id="ctyid" asp-for="CityId" class="form-control" asp-items="@(ViewBag.CityId)">
                        <option value="1">Select City</option>
                    </select>
                    <span asp-validation-for="CityId" class="text-danger"></span>
                </div>
            </div>


            <div class="mb-3 col-lg-12 mt-1">
                <label asp-for="ImageProfile" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <img src="~/ProfileImages/@Model.ImageProfile" width="400" height="300" id="img1" class="img-rounded img-fluid center-block" src="" />
                    <input value="@Model.ImageProfile"  type="file" name="myfile" id="file" accept=".png,.jpg,.jpeg,.gif,.tif" class="btn btn-info col-lg-12 input-sm" />
                    <input placeholder="هذا الحقل ضروري" readonly asp-for="ImageProfile" id="fileinput" class="form-control input-sm" />
                    <span asp-validation-for="ImageProfile" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1" hidden>
                <label asp-for="DAL" class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    <input asp-for="DAL" class="form-control" />
                    <span asp-validation-for="DAL" class="text-danger"></span>
                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <label class="col-md-2 control-label"></label>
                <div class="col-md-10">
                    @*<a id="followbtn" class="btn-sm btn-secondary rounded-0">تاكيد البريد الإلكتروني</a>
                        <a id="followbtn" class="btn-sm btn-secondary rounded-0">تأكيد رقم الهاتف</a>*@
                    <a class="btn-sm btn-danger rounded-0" asp-route-id="@Model.Id" asp-action="ControlPanel">لوحة التحكم</a>
                    <input type="submit" value="حفظ" class="btn-sm btn-success rounded-0" />
                    @*<a class="btn btn-primary rounded-0" asp-action="Index">رجوع</a>*@
                    @*<a class="btn btn-warning" asp-action="UserStatements" asp-controller="Statements" asp-route-id="@Model.Id">Statement</a>*@

                </div>
            </div>
            <div class="mb-3 col-lg-12 mt-1">
                <div class="col-md-offset-2 col-md-10">
                </div>
            </div>
        </form>
    </div>
</div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            //$('#img1').hide();
            $("#file").change(function () {
                if ($("#file").val() != "") {
                    $("#fileinput").prop("value", $("#file").val().split('\\').pop());
                    if ($('#startdate').val() != null && $('#enddate').val() != null > 0 && $('#arname').val().length > 0 && $('#fileinput').val().length > 0) {
                        $('#next1').attr('disabled', false)
                        $('#next1').removeClass('btn-secondary')
                        $('#next1').addClass('btn-success')
                    }
                    else {
                        $('#next1').attr('disabled', true)
                        $('#next1').addClass('btn-secondary')
                        $('#next1').removeClass('btn-success')
                    }

                }
                if (this.files && this.files[0]) {
                    $('#img1').fadeIn();
                    var reader = new FileReader();
                    reader.onload = function (e) { $('#img1').attr('src', e.target.result); }
                    reader.readAsDataURL(this.files[0]);
                }
            });
        });
    </script>

    <script>
        $(document).ready(function () {
            // $("#ctyid").prop("disabled", true);
            $("#cntid").change(function () {
                //  $("#ctyid").prop("disabled", true);
                $("#ctyid").empty();
                $("#ctyid").append($('<option>', { text: "Select City" }));
                if ($("#cntid").val() > 0) {
                    var CountryOptions = {};
                    CountryOptions.url = "/Home/GetCitiesList/";
                    CountryOptions.data = { countryid: $("#cntid").val() };
                    CountryOptions.success = function (data) {
                        $.each(data, function (index, row) {
                            $("#ctyid").append($('<option>', { value: row.value, text: row.text }))
                        });
                        //  $("#ctyid").prop("disabled", false);
                    };
                    CountryOptions.error = function () { alert("Error: can't retrieve the list of cities!!!!"); };
                    $.ajax(CountryOptions);
                }
            });
        });
    </script>
    @{ await Html.RenderPartialAsync("_ValidationScriptsPartial"); }
}

